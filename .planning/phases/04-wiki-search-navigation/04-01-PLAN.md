---
phase: 04-wiki-search-navigation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [app/src/components/SearchBar.tsx, app/src/components/SearchResults.tsx, app/src/components/Header.tsx]
autonomous: true
---

<objective>
Build instant search UI that uses existing Convex full-text search.

Purpose: Allow staff to quickly find documents by searching content.
Output: Search bar in header with dropdown results, keyboard navigation.
</objective>

<context>
@.planning/PROJECT.md
@app/convex/documents.ts (has search query)
@app/src/components/Header.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SearchBar component</name>
  <files>app/src/components/SearchBar.tsx</files>
  <action>
Create `src/components/SearchBar.tsx`:

- Input field with search icon
- Debounced input (300ms) to avoid excessive queries
- Opens dropdown on focus/typing
- Closes on blur or Escape key
- Uses design system tokens (font, colors, borders)
- Placeholder: "Search documents..."
  </action>
  <verify>SearchBar renders with proper styling</verify>
  <done>SearchBar component created</done>
</task>

<task type="auto">
  <name>Task 2: Create SearchResults dropdown</name>
  <files>app/src/components/SearchResults.tsx</files>
  <action>
Create `src/components/SearchResults.tsx`:

- Takes search query as prop
- Uses `useQuery(api.documents.search, { searchQuery })`
- Shows loading state while searching
- Displays results with title, category badge, content snippet
- "No results found" for empty results
- Links to document pages
- Keyboard navigation (arrow keys, Enter to select)
  </action>
  <verify>SearchResults shows results from Convex</verify>
  <done>SearchResults dropdown created</done>
</task>

<task type="auto">
  <name>Task 3: Add SearchBar to Header</name>
  <files>app/src/components/Header.tsx</files>
  <action>
Update Header to include SearchBar:

1. Add SearchBar between brand and UserMenu
2. Position with flexbox
3. Style to fit header aesthetic
4. Test search functionality
  </action>
  <verify>Search works from header</verify>
  <done>SearchBar integrated in Header</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] SearchBar renders in header
- [ ] Typing triggers search query
- [ ] Results display with links
- [ ] Keyboard navigation works
- [ ] Clicking result navigates to document
</verification>

<success_criteria>
- Staff can search documents from any page
- Results appear instantly (debounced)
- Results link to correct document pages
</success_criteria>

<output>
After completion, create `.planning/phases/04-wiki-search-navigation/04-01-SUMMARY.md`
</output>
