---
phase: 28-navigation-refinement
plan: 03
type: execute
wave: 3
depends_on: ["28-01", "28-02"]
files_modified:
  - app/src/components/Header.tsx
  - app/src/app/procedures/page.tsx
  - app/src/app/references/page.tsx
  - app/src/app/checklists/page.tsx
  - app/src/app/guides/page.tsx
autonomous: false
---

<objective>
Update the main navigation to use context-based organization and handle legacy routes.

Purpose: Replace type-based navigation (Procedures, References, Checklists, Guides) with context-based navigation (Events, Services, Operations) while maintaining backwards compatibility.

Output: Updated Header with new nav structure, legacy routes redirect to appropriate context pages.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/28-navigation-refinement/28-CONTEXT.md

# Current navigation:
@app/src/components/Header.tsx

# New pages from Plan 02:
@app/src/app/events/page.tsx
@app/src/app/services/page.tsx
@app/src/app/operations/page.tsx

# Legacy routes to update:
@app/src/app/procedures/page.tsx
@app/src/app/references/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update Header.tsx navigation</name>
  <files>app/src/components/Header.tsx</files>
  <action>
Update the navItems array to use context-based navigation:

```typescript
const navItems = [
  { href: "/", label: "Home" },
  { href: "/events", label: "Events" },
  { href: "/services", label: "Services" },
  { href: "/operations", label: "Operations" },
  { href: "/style-guides", label: "Style Guides" },
  // CONNECTOR: Messages, Forms, Activity routes - restore from feature/full-v1
  { href: "/workspace", label: "My Workspace" },
];
```

Changes from current:
- Remove: /procedures, /references, /checklists, /guides
- Add: /events, /services, /operations
- Keep: Home, Style Guides, My Workspace

Preserve all existing CONNECTOR comments for feature/full-v1 restoration.
  </action>
  <verify>`cd app && npx tsc --noEmit`</verify>
  <done>Header shows Events, Services, Operations in navigation</done>
</task>

<task type="auto">
  <name>Task 2: Convert legacy routes to redirects</name>
  <files>app/src/app/procedures/page.tsx, app/src/app/references/page.tsx, app/src/app/checklists/page.tsx, app/src/app/guides/page.tsx</files>
  <action>
Convert the legacy type-based routes to redirect to the most relevant context page.

For each legacy route, replace the page content with a redirect:

**procedures/page.tsx:**
```typescript
import { redirect } from "next/navigation";
export default function ProceduresPage() {
  redirect("/operations");
}
```

**references/page.tsx:**
```typescript
import { redirect } from "next/navigation";
export default function ReferencesPage() {
  redirect("/events");
}
```

**checklists/page.tsx:**
```typescript
import { redirect } from "next/navigation";
export default function ChecklistsPage() {
  redirect("/events");
}
```

**guides/page.tsx:**
```typescript
import { redirect } from "next/navigation";
export default function GuidesPage() {
  redirect("/style-guides");
}
```

Redirect mapping rationale:
- /procedures → /operations (procedures are staff operations)
- /references → /events (most references are client-facing)
- /checklists → /events (checklists are client planning tools)
- /guides → /style-guides (guides are design documentation)

Note: These are server-side redirects using Next.js redirect(). No "use client" directive needed.
  </action>
  <verify>`cd app && bun run build` succeeds</verify>
  <done>Legacy routes redirect to appropriate context pages</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Context-based navigation system with:
- New header navigation: Home, Events, Services, Operations, Style Guides, My Workspace
- Three context pages with type filter chips
- Legacy route redirects
  </what-built>
  <how-to-verify>
1. Run: `cd app && bun run dev`
2. Visit: http://localhost:3000

**Navigation check:**
3. Verify header shows: Home | Events | Services | Operations | Style Guides | My Workspace
4. Click "Events" - should show client content with type filter chips
5. Click "Services" - should show services/pricing content
6. Click "Operations" - should show staff procedures and operations content

**Type filter check:**
7. On Events page, click different type chips (All, Procedure, Reference, Checklist, etc.)
8. Verify document list filters correctly

**Redirect check:**
9. Visit http://localhost:3000/procedures - should redirect to /operations
10. Visit http://localhost:3000/references - should redirect to /events
11. Visit http://localhost:3000/checklists - should redirect to /events

**Document links check:**
12. Click any document in the list
13. Verify it opens the document viewer correctly

**Screenshot folder:** Save verification screenshots to `.planning/phases/28-navigation-refinement/screenshots/`
  </how-to-verify>
  <resume-signal>Type "approved" to complete the phase, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd app && bun run build` succeeds
- [ ] Header shows new navigation structure
- [ ] Legacy routes redirect correctly
- [ ] Visual verification passed
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Navigation flows intuitively
- No broken links
- Type filters work within each context
- User approved visual layout
</success_criteria>

<output>
After completion, create `.planning/phases/28-navigation-refinement/28-03-SUMMARY.md`
</output>
