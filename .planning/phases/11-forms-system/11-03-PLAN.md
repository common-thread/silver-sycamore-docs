---
phase: 11-forms-system
plan: 03
type: execute
wave: 2
depends_on: ["11-01"]
files_modified: [app/src/components/FormRenderer.tsx, app/src/app/f/[formId]/page.tsx]
autonomous: true
---

<objective>
Build the form renderer component and public form page for external respondents.

Purpose: Allow clients/external users to fill out and submit forms via shareable links.
Output: Dynamic FormRenderer component and public /f/[formId] route.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-forms-system/11-CONTEXT.md
@.planning/02-form-schemas.md

@app/src/components/SuggestionForm.tsx
@app/src/app/signin/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FormRenderer component</name>
  <files>app/src/components/FormRenderer.tsx</files>
  <wireframe>
+--------------------------------------------------+
|  Wedding Booking Form                            |
|  Please fill out the details below               |
+--------------------------------------------------+
|                                                  |
|  Name *                                          |
|  [____________________]                          |
|                                                  |
|  Email *                                         |
|  [____________________]                          |
|                                                  |
|  Event Date *                                    |
|  [____________________]                          |
|                                                  |
|  Guest Count                                     |
|  [____________________]                          |
|                                                  |
|  Event Type *                                    |
|  [Select an option v]                            |
|                                                  |
|  Additional Notes                                |
|  [                    ]                          |
|  [____________________]                          |
|                                                  |
|                              [Submit]            |
+--------------------------------------------------+
  </wireframe>
  <action>
Create FormRenderer.tsx that dynamically renders form fields:

Props:
- `formSchema`: The form definition with parsed fields
- `onSubmit`: Callback with form data
- `isSubmitting`: Loading state

Render each field based on type:
- text/email/tel → Input with appropriate type
- textarea → Textarea component
- number → Input type="number"
- date/time → Input type="date" / type="time"
- select → Select dropdown with options
- multiselect → Multiple checkboxes or multi-select
- checkbox → Single checkbox
- file → File input (store as base64 or integrate with Convex storage)

Validation:
- Mark required fields with asterisk
- Validate required fields before submit
- Show inline error messages

Use controlled inputs with useState for form data.
Use existing Input, Button components from ui/.
Follow design system (Playfair for headings, DM Sans for body).
  </action>
  <verify>bun run build (no type errors)</verify>
  <done>FormRenderer renders all field types, validates, submits data</done>
</task>

<task type="auto">
  <name>Task 2: Create public form page</name>
  <files>app/src/app/f/[formId]/page.tsx</files>
  <action>
Create public form route at /f/[formId]:

- This page does NOT require authentication
- Get formId from params (string formId, not Convex ID)
- Query form with `api.forms.getByFormId` (public query)
- If form not found or not published → show 404 message
- Render FormRenderer with form schema
- On submit, call `api.forms.submitResponse` mutation
- Include respondent name/email fields at top (optional)
- Show success message after submission with "Thank you" state

**Important considerations:**
- No auth wrapper - this is public
- Use `useQuery` without auth for form data
- Use `useMutation` for submission (also public)
- Clean, minimal layout - no header/sidebar
- Mobile-friendly responsive design

Layout should be centered, max-width container, clean white background.
Show form title and description prominently.
  </action>
  <verify>bun run build && bun run dev (page loads without auth)</verify>
  <done>Public form page works, submission saves to database</done>
</task>

<task type="auto">
  <name>Task 3: Add submission success state</name>
  <files>app/src/app/f/[formId]/page.tsx</files>
  <wireframe>
Success State:
+--------------------------------------------------+
|                                                  |
|            [Checkmark Icon]                      |
|                                                  |
|         Thank you for your submission!           |
|                                                  |
|    We've received your response and will        |
|    be in touch soon.                            |
|                                                  |
|         [Submit Another Response]                |
|                                                  |
+--------------------------------------------------+
  </wireframe>
  <action>
Add success state to the public form page:

- After successful submission, show thank you message
- Center content with checkmark icon (use Lucide check-circle)
- Display form title in success message
- "Submit Another Response" button to reset form
- Clean transition from form to success state

Track submission state: "idle" | "submitting" | "success" | "error"
On error, show error message and allow retry.
  </action>
  <verify>bun run build</verify>
  <done>Success state shows after submission, can submit again</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `bun run build` succeeds
- [ ] FormRenderer handles all field types
- [ ] Public /f/[formId] page loads without auth
- [ ] Form submission works and saves to database
- [ ] Success state displays after submission
</verification>

<success_criteria>
- All tasks completed
- External users can fill out forms via public link
- All field types render and validate correctly
- Submissions are stored in database
</success_criteria>

<output>
After completion, create `.planning/phases/11-forms-system/11-03-SUMMARY.md`
</output>
