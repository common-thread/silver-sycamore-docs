---
phase: 16-code-mapping-style-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [.planning/phases/16-code-mapping-style-audit/USER-FLOWS.md, .planning/phases/16-code-mapping-style-audit/COMPONENT-MAP.md]
autonomous: true
---

<objective>
Map current navigation structure and user flows to underlying architecture.

Purpose: Create foundation for v1.2 content architecture refactoring by documenting how the app actually works today — from user perspective through to component/data layer.
Output: USER-FLOWS.md (human-readable flow documentation) and COMPONENT-MAP.md (machine-parseable component-to-data mapping)
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-code-mapping-style-audit/16-CONTEXT.md
@.planning/codebase/STRUCTURE.md

# Key source files to analyze:
@app/src/app/layout.tsx
@app/src/app/page.tsx
@app/src/components/Header.tsx
@app/convex/schema.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Map navigation structure and user flows</name>
  <files>.planning/phases/16-code-mapping-style-audit/USER-FLOWS.md</files>
  <action>
Analyze the app from user perspective and document all navigation flows:

1. **Primary Navigation Analysis:**
   - Read Header.tsx to extract all nav items and their destinations
   - Read layout.tsx to understand app shell structure
   - Map each nav item to its route and what content type it leads to

2. **Route Analysis:**
   - Scan all directories under app/src/app/ to catalog routes
   - For each route, identify: URL pattern, page component, what it displays
   - Note dynamic routes ([category]/[slug], [formId], etc.)

3. **User Flow Documentation:**
   - Document main user journeys: Browse docs → View doc → Edit/Comment
   - Document secondary flows: Search, Workspace, Messages, Forms
   - Identify navigation pain points mentioned in STATE.md (e.g., "Clients" nav misleading)

Create USER-FLOWS.md with:
- Navigation hierarchy (ASCII tree)
- Route catalog table (route, component, purpose, content type)
- User journey diagrams (ASCII flowcharts)
- Pain points identified (from STATE.md backlog)

Format for human readability but with consistent structure for machine parsing.
  </action>
  <verify>USER-FLOWS.md exists with navigation hierarchy, route catalog, and at least 3 documented user journeys</verify>
  <done>Complete navigation map from user perspective with identified pain points</done>
</task>

<task type="auto">
  <name>Task 2: Create component-to-data flow documentation</name>
  <files>.planning/phases/16-code-mapping-style-audit/COMPONENT-MAP.md</files>
  <action>
Map how components connect to data layer:

1. **Component Inventory:**
   - List all components in app/src/components/
   - Categorize by type: UI primitive, feature component, layout component, page component
   - Note component sizes (from CONCERNS.md fragile areas list)

2. **Data Flow Tracing:**
   - For key page components, trace data flow:
     - What Convex queries/mutations does it use?
     - What props does it receive?
     - What child components does it render?
   - Focus on: DocumentViewer, FormBuilder, FormRenderer, Header, MessageList

3. **Schema Mapping:**
   - Read convex/schema.ts to understand data model
   - Map which components interact with which tables
   - Identify component-to-table relationships

Create COMPONENT-MAP.md with:
- Component inventory table (name, category, size, data dependencies)
- Data flow diagrams for key features (ASCII)
- Component-to-Convex-table mapping
- YAML frontmatter with machine-parseable component list

Format:
```yaml
---
components:
  - name: DocumentViewer
    category: feature
    queries: [documents.bySlug]
    mutations: []
    tables: [documents]
  - name: FormBuilder
    category: feature
    queries: [forms.byId]
    mutations: [forms.update, formFields.create]
    tables: [forms, formFields]
---
```
  </action>
  <verify>COMPONENT-MAP.md exists with YAML frontmatter containing component inventory and at least 5 key component data flow mappings</verify>
  <done>Complete component-to-data mapping with machine-parseable format</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] USER-FLOWS.md exists and contains navigation hierarchy
- [ ] USER-FLOWS.md contains route catalog with all app routes
- [ ] USER-FLOWS.md documents at least 3 user journeys
- [ ] COMPONENT-MAP.md exists with YAML frontmatter
- [ ] COMPONENT-MAP.md maps at least 5 key components to their data dependencies
- [ ] Both files are human-readable AND machine-parseable
</verification>

<success_criteria>
- All tasks completed
- Navigation structure fully documented
- Component-to-data relationships mapped
- Outputs serve both human review and machine consumption for subsequent phases
</success_criteria>

<output>
After completion, create `.planning/phases/16-code-mapping-style-audit/16-01-SUMMARY.md`
</output>
