---
phase: 17-base-component-fixes
plan: 04
type: execute
wave: 2
depends_on: ["17-01"]
files_modified:
  - app/src/components/CommentSection.tsx
  - app/src/components/MessageList.tsx
  - app/src/components/ui/Button.tsx
  - app/src/components/ui/Badge.tsx
  - app/src/components/ui/Card.tsx
  - app/src/components/ui/Input.tsx
autonomous: false
---

<objective>
Complete design token adoption in feature components (CommentSection, MessageList) and UI primitives (Button, Badge, Card, Input), then verify full phase completion.

Purpose: These remaining 28 violations complete the style audit cleanup. The checkpoint verifies visual consistency across the entire app.

Output: All components using design tokens exclusively. Zero style violations remaining.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/16-code-mapping-style-audit/STYLE-VIOLATIONS.md
@.planning/phases/17-base-component-fixes/17-01-SUMMARY.md
@app/src/components/CommentSection.tsx
@app/src/components/MessageList.tsx
@app/src/components/ui/Button.tsx
@app/src/components/ui/Badge.tsx
@app/src/components/ui/Card.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix CommentSection.tsx and MessageList.tsx</name>
  <files>app/src/components/CommentSection.tsx, app/src/components/MessageList.tsx</files>
  <action>
**CommentSection.tsx (10 violations):**

Spacing:
- Line 98: `"1.5rem 0"` → `"var(--space-6) 0"`
- Line 150: `"1.5rem"` → `"var(--space-6)"`
- Line 176: `"1rem"` → `"var(--space-4)"`
- Line 199: `"0.5rem 1rem"` → `"var(--space-2) var(--space-4)"`

Typography:
- Line 100: `"0.875rem"` → `"var(--text-sm)"`
- Line 123: `"1.25rem"` → `"var(--text-xl)"`
- Line 124: `600` → `"var(--font-semibold)"`
- Line 134: `"0.8125rem"` → `"var(--text-xs)"`
- Line 201: `"0.8125rem"` → `"var(--text-xs)"`

Border:
- Line 178: `"4px"` → `0` (brand aesthetic)
- Line 206: `"2px"` → `0` (brand aesthetic)

Transition:
- Line 209: `"0.15s ease"` → `"var(--duration-fast) var(--ease-default)"`

**MessageList.tsx (8 violations):**

Spacing:
- Line 147: `"2rem"` → `"var(--space-8)"`
- Line 152: `"48px"` → `"var(--space-12)"`
- Line 154: `"0 auto 1rem"` → `"0 auto var(--space-4)"`
- Line 222: `"1rem 1.5rem"` → `"var(--space-4) var(--space-6)"`
- Line 223: `"1rem"` → `"var(--space-4)"`

Typography:
- Line 129: `"0.9375rem"` → `"var(--text-sm)"`
- Line 176: `"0.9375rem"` → `"var(--text-sm)"`
- Line 237: `"0.75rem"` → `"var(--text-xs)"`
- Line 240: `"0.05em"` → `"var(--tracking-wide)"`
  </action>
  <verify>grep for hardcoded values like "0.9375rem", "48px", "0.15s" in CommentSection.tsx and MessageList.tsx returns no results</verify>
  <done>CommentSection.tsx and MessageList.tsx use design tokens exclusively. 18 violations fixed.</done>
</task>

<task type="auto">
  <name>Task 2: Fix UI primitive components</name>
  <files>app/src/components/ui/Button.tsx, app/src/components/ui/Badge.tsx, app/src/components/ui/Card.tsx, app/src/components/ui/Input.tsx</files>
  <action>
**Button.tsx (5 violations):**

Typography:
- Line 37: `"0.02em"` → `"var(--tracking-normal)"` or remove if not needed
- Line 54: `"0.8125rem"` → `"var(--text-xs)"`
- Line 59: `"0.875rem"` → `"var(--text-sm)"`

Spacing:
- Line 53: `"0.5rem 1rem"` → `"var(--space-2) var(--space-4)"`
- Line 55: `"2rem"` min-height → `"var(--space-8)"`
- Line 58: `"0.75rem 1.5rem"` → `"var(--space-3) var(--space-6)"`
- Line 60: `"2.5rem"` min-height → `"var(--space-10)"`

Transition:
- Line 45: `"180ms ease-out"` → `"var(--duration-fast) var(--ease-out)"`

**Badge.tsx (1 violation):**
- Line 31: Hardcoded `rgba(76, 130, 76, 0.12)` / `#3D6B3D` → use `var(--color-success)` with opacity or create success-bg token if needed

**Card.tsx (3 violations):**
- Line 46: Custom shadow → `"var(--shadow-sm)"` or `"var(--shadow-md)"`
- Line 85: Custom shadow → `"var(--shadow-lg)"`
- Line 92: Custom shadow → `"var(--shadow-xs)"`

**Input.tsx (remaining after error color fix):**
- Line 100: `"0.8125rem"` → `"var(--text-xs)"`
- Line 124: `"180ms ease-out"` → `"var(--duration-fast) var(--ease-out)"`

Note: Error colors in Input were already fixed in Plan 17-01.
  </action>
  <verify>grep for hardcoded shadow, "180ms", "0.8125rem" in Button, Badge, Card, Input returns no results</verify>
  <done>All UI primitive components use design tokens. 10 violations fixed.</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete design token adoption across all 89 style violations in the codebase</what-built>
  <how-to-verify>
    1. Run: `cd app && bun run dev`
    2. Visit: http://localhost:3000
    3. Navigate through:
       - Home page (Header visible)
       - Any document page (DocumentViewer)
       - Forms section (FormRenderer, FormBuilder)
       - Comments on a document (CommentSection)
       - Messages (MessageList)
    4. Verify: Consistent visual appearance - no jarring color differences, spacing feels uniform
    5. Verify: Error states (try submitting empty form) use the muted #8B4D4D red, not bright #C75050
    6. Verify: All buttons, inputs, cards have consistent styling
    7. Run: `grep -r "#C75050\|0\.8125rem\|0\.9375rem" app/src/components/` returns no results
  </how-to-verify>
  <resume-signal>Type "approved" if visual consistency is achieved, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] All 28 violations in feature/UI components fixed
- [ ] `grep -r "#C75050" app/src/components/` returns no results
- [ ] `grep -r "0\.8125rem" app/src/components/` returns no results
- [ ] `bun run build` in app/ succeeds without errors
- [ ] Human verification approved
</verification>

<success_criteria>

- All 89 style violations from Phase 16 audit fixed
- Every component uses design tokens exclusively
- Visual consistency across the entire application
- Build passes without errors
- Human verification confirms consistent appearance
</success_criteria>

<output>
After completion, create `.planning/phases/17-base-component-fixes/17-04-SUMMARY.md`
</output>
