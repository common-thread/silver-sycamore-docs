---
phase: 11-forms-system
plan: 02
type: execute
wave: 2
depends_on: ["11-01"]
files_modified: [app/src/app/forms/page.tsx, app/src/app/forms/new/page.tsx, app/src/app/forms/[formId]/edit/page.tsx, app/src/components/FormBuilder.tsx, app/src/components/FieldEditor.tsx]
autonomous: true
---

<objective>
Build the form builder UI that allows staff to create and edit forms with various field types.

Purpose: Give staff autonomy to create, customize, and manage their own forms without developer intervention.
Output: Form builder page with field editor, create/edit flows, forms list page.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/11-forms-system/11-CONTEXT.md

@app/src/components/SuggestionForm.tsx
@app/src/components/CreateChannelDialog.tsx
@app/src/app/workspace/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create FormBuilder component</name>
  <files>app/src/components/FormBuilder.tsx</files>
  <wireframe>
+--------------------------------------------------+
|  Form Builder                                    |
+--------------------------------------------------+
|  Title: [____________________]                   |
|  Description: [____________________]             |
+--------------------------------------------------+
|  FIELDS                              [+ Add Field]|
|  +--------------------------------------------+  |
|  | Name [text]        [Required] [Edit] [Del] |  |
|  +--------------------------------------------+  |
|  | Email [email]      [Required] [Edit] [Del] |  |
|  +--------------------------------------------+  |
|  | Event Date [date]  [    ]     [Edit] [Del] |  |
|  +--------------------------------------------+  |
|                                                  |
|  [Cancel]                    [Save Draft] [Save] |
+--------------------------------------------------+
  </wireframe>
  <action>
Create FormBuilder.tsx component that:
- Takes optional `formId` prop for edit mode
- Manages form state: title, description, fields array
- Allows adding/removing/reordering fields
- Each field has: name, type, label, required, options (for select)
- Uses FieldEditor component (Task 2) for editing individual fields
- Save button calls create or update mutation
- Shows loading state during save
- Redirects to forms list after save

Field types to support:
- text, textarea, number, date, time, email, tel
- select (single), multiselect, checkbox
- file (for uploads)

Use existing UI patterns from SuggestionForm.tsx for form layout.
Use Button, Input from ui/ components.
  </action>
  <verify>bun run build (no type errors)</verify>
  <done>FormBuilder renders, manages field state, saves to backend</done>
</task>

<task type="auto">
  <name>Task 2: Create FieldEditor component</name>
  <files>app/src/components/FieldEditor.tsx</files>
  <wireframe>
+------------------------------------------+
|  Edit Field                              |
+------------------------------------------+
|  Label: [____________________]           |
|  Field Name: [____________________]      |
|  Type: [Select v]                        |
|                                          |
|  [x] Required                            |
|                                          |
|  Options (for select/multiselect):       |
|  [Option 1] [x]                          |
|  [Option 2] [x]                          |
|  [+ Add Option]                          |
|                                          |
|  [Cancel]                    [Save Field]|
+------------------------------------------+
  </wireframe>
  <action>
Create FieldEditor.tsx as a modal/dialog for editing field properties:
- Props: field (current field data), onSave, onCancel
- Inputs for: label, name (auto-slugify from label), type dropdown
- Checkbox for required
- Conditional options editor for select/multiselect types
- Options are managed as string array with add/remove buttons
- Validate: name must be unique, label required

Use Dialog pattern from CreateChannelDialog.tsx.
Field name should auto-generate from label (lowercase, spaces to underscores).
  </action>
  <verify>bun run build (no type errors)</verify>
  <done>FieldEditor dialog opens, edits field, returns updated field</done>
</task>

<task type="auto">
  <name>Task 3: Create forms pages (list, new, edit)</name>
  <files>app/src/app/forms/page.tsx, app/src/app/forms/new/page.tsx, app/src/app/forms/[formId]/edit/page.tsx</files>
  <wireframe>
Forms List Page:
+--------------------------------------------------+
|  Forms                            [+ New Form]   |
+--------------------------------------------------+
|  +--------------------------------------------+  |
|  | Wedding Booking Form            [Published] |  |
|  | 5 submissions                    [Edit]     |  |
|  +--------------------------------------------+  |
|  | Corporate Event Form            [Draft]     |  |
|  | 0 submissions                    [Edit]     |  |
|  +--------------------------------------------+  |
+--------------------------------------------------+
  </wireframe>
  <action>
Create three pages:

**app/src/app/forms/page.tsx** - Forms list
- Query user's forms with `api.forms.list`
- Show title, status (Published/Draft), submission count
- Link to edit page
- Button to create new form
- Use PageHeader component

**app/src/app/forms/new/page.tsx** - Create new form
- Render FormBuilder with no formId
- PageHeader with "New Form" title

**app/src/app/forms/[formId]/edit/page.tsx** - Edit form
- Get formId from params
- Query form with `api.forms.get`
- Render FormBuilder with form data
- PageHeader with form title

All pages require auth (use existing auth check pattern).
Follow routing pattern from workspace/ pages.
  </action>
  <verify>bun run build && bun run dev (pages load)</verify>
  <done>All three pages work, form CRUD functional</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `bun run build` succeeds
- [ ] Forms list page shows user's forms
- [ ] New form page creates form with fields
- [ ] Edit page loads and updates existing form
- [ ] All field types can be added and configured
</verification>

<success_criteria>
- All tasks completed
- Staff can create forms with multiple field types
- Staff can edit existing forms
- Forms list shows all user's forms
</success_criteria>

<output>
After completion, create `.planning/phases/11-forms-system/11-02-SUMMARY.md`
</output>
