---
phase: 02-authentication
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified: [app/src/components/ConvexClientProvider.tsx, app/src/app/signin/page.tsx, app/src/components/UserMenu.tsx]
autonomous: false
domain: frontend-design
invoke_skills: ["frontend-design"]
---

<objective>
Create authentication UI with sign-in page and user menu following design system.

Purpose: Provide staff with a way to sign in/out using the design system aesthetic.
Output: Sign-in page, user menu component, updated Convex provider.
</objective>

<context>
@.planning/PROJECT.md
@.planning/phases/02-authentication/RESEARCH.md
@.planning/phases/02-authentication/02-01-SUMMARY.md
@.planning/phases/01-design-system/01-01-SUMMARY.md
@.planning/phases/01-design-system/01-02-SUMMARY.md
@app/src/components/ConvexClientProvider.tsx
@app/src/app/globals.css
</context>

<skill_usage>
**REQUIRED**: Invoke `/frontend-design` skill for sign-in page design.

Provide:
- Purpose: Staff authentication for internal knowledge hub
- Design tokens available from Phase 01
- Request: Sign-in form with editorial aesthetic, error states, loading states

The skill ensures the sign-in page feels distinctive and professional.
</skill_usage>

<tasks>

<task type="auto">
  <name>Task 1: Update ConvexClientProvider with auth</name>
  <files>app/src/components/ConvexClientProvider.tsx</files>
  <action>
Update provider to use ConvexAuthProvider:

```typescript
"use client";

import { ConvexAuthProvider } from "@convex-dev/auth/react";
import { ConvexReactClient } from "convex/react";
import { ReactNode } from "react";

const convex = new ConvexReactClient(process.env.NEXT_PUBLIC_CONVEX_URL!);

export function ConvexClientProvider({ children }: { children: ReactNode }) {
  return (
    <ConvexAuthProvider client={convex}>
      {children}
    </ConvexAuthProvider>
  );
}
```
  </action>
  <verify>Provider updated, app still loads</verify>
  <done>ConvexAuthProvider integrated</done>
</task>

<task type="auto">
  <name>Task 2: Create sign-in page</name>
  <files>app/src/app/signin/page.tsx</files>
  <action>
1. Invoke `/frontend-design` skill for sign-in page design
2. Create `app/src/app/signin/page.tsx`:

**Requirements:**
- Centered card layout
- Silver Sycamore branding at top
- Email and password fields using Input component
- Sign In / Sign Up toggle
- Error message display
- Loading state on submit
- Use design tokens from Phase 01
- Editorial/archival aesthetic

**State handling:**
- Use `useAuthActions` for signIn
- Use `useState` for form state, errors, loading
- Toggle between signIn and signUp flows

**Form fields:**
- Email (type="email")
- Password (type="password")
- Hidden flow field
  </action>
  <verify>Sign-in page renders, form submits</verify>
  <done>Sign-in page created with design system styling</done>
</task>

<task type="auto">
  <name>Task 3: Create UserMenu component</name>
  <files>app/src/components/UserMenu.tsx</files>
  <action>
Create UserMenu component for header:

**Requirements:**
- Show current user email/name when authenticated
- Sign out button
- Use design system styling
- Compact design for header integration

**Implementation:**
```typescript
"use client";

import { useAuthActions } from "@convex-dev/auth/react";
import { useConvexAuth, useQuery } from "convex/react";
import { api } from "../../convex/_generated/api";

export function UserMenu() {
  const { isAuthenticated, isLoading } = useConvexAuth();
  const { signOut } = useAuthActions();

  // Query current user from users table
  // Display email and sign out button
}
```
  </action>
  <verify>UserMenu shows user info and sign out works</verify>
  <done>UserMenu component created</done>
</task>

<task type="auto">
  <name>Task 4: Add UserMenu to Header</name>
  <files>app/src/components/Header.tsx</files>
  <action>
Update Header component to include UserMenu:

1. Import UserMenu
2. Add to right side of brand bar
3. Style to fit header design
  </action>
  <verify>Header shows UserMenu, sign out works</verify>
  <done>Header includes UserMenu</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Sign-in page and user menu with design system styling</what-built>
  <how-to-verify>
    1. Run: cd app && bun run dev
    2. Navigate to: http://localhost:3001/signin
    3. Check sign-in page:
       - Editorial aesthetic matching design system
       - Form inputs styled correctly
       - Sign In / Sign Up toggle works
       - Error messages display properly
    4. Test sign up with test email/password
    5. After sign in, check header shows user menu
    6. Test sign out
  </how-to-verify>
  <resume-signal>Type "approved" if auth UI is complete, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] ConvexAuthProvider in use
- [ ] Sign-in page exists and renders
- [ ] Sign up creates user
- [ ] Sign in authenticates user
- [ ] UserMenu shows in header
- [ ] Sign out works
- [ ] Design matches Phase 01 aesthetic
</verification>

<success_criteria>
- Sign-in page with editorial design
- Working sign up and sign in flows
- User menu in header with sign out
- Human verified
</success_criteria>

<output>
After completion, create `.planning/phases/02-authentication/02-02-SUMMARY.md`
Record: UI design decisions, any flow adjustments, screenshots
</output>
