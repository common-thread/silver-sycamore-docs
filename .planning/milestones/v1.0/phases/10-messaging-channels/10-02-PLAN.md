---
phase: 10-messaging-channels
plan: 02
type: execute
wave: 2
depends_on: ["10-01"]
files_modified: [app/src/app/messages/page.tsx, app/src/app/messages/layout.tsx, app/src/app/messages/[channelId]/page.tsx, app/src/components/ChannelList.tsx, app/src/components/CreateChannelDialog.tsx]
autonomous: true
---

<objective>
Build channel browsing UI with sidebar navigation and channel creation.

Purpose: Give users ability to see their channels and create new ones.
Output: /messages route with channel list sidebar and create channel functionality.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Schema and backend from Plan 01
@.planning/phases/10-messaging-channels/10-01-SUMMARY.md

# UI patterns to follow
@app/src/components/ui/Button.tsx
@app/src/components/ui/Input.tsx
@app/src/components/ui/Card.tsx
@app/src/components/Header.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create /messages layout with channel sidebar</name>
  <files>app/src/app/messages/layout.tsx, app/src/app/messages/page.tsx</files>
  <action>
Create messaging area layout:

**layout.tsx:**
- Two-column layout: sidebar (channels) + main content (children)
- Sidebar: ~280px width, full height minus header
- Use CSS grid or flex for responsive behavior
- Include "Messages" header in sidebar with "+" button for new channel

**page.tsx (index):**
- Default view when no channel selected
- Show welcome message: "Select a channel to start messaging"
- Center-aligned, muted text
- Include quick actions: "Create Channel" button, "Start DM" button

**Styling:**
- Follow design system: ink/paper colors, DM Sans font
- Sidebar background slightly different for visual separation
- Sharp corners consistent with design system
  </action>
  <verify>Visit /messages, see two-column layout with sidebar</verify>
  <done>Messages layout renders with sidebar placeholder</done>
</task>

<task type="auto">
  <name>Task 2: Create ChannelList component</name>
  <files>app/src/components/ChannelList.tsx</files>
  <action>
Build channel list sidebar component:

**ChannelList.tsx:**
- Use `useQuery(api.channels.listUserChannels)` for real-time channel list
- Group channels by type:
  - "Channels" section: public and private channels
  - "Direct Messages" section: dm type channels
- Each channel item shows:
  - Hash (#) icon for public, lock icon for private, avatar for DM
  - Channel name (or other user's name for DMs)
  - Unread indicator dot if messages since lastReadAt
- Active state when current route matches channelId
- Link to /messages/[channelId] on click

**Empty states:**
- "No channels yet" with "Create one" link
- "No direct messages" with "Start a conversation" link

**Props:**
- `currentChannelId?: string` - for highlighting active channel
  </action>
  <verify>ChannelList renders user's channels with proper grouping</verify>
  <done>Channel list shows user's channels with navigation</done>
</task>

<task type="auto">
  <name>Task 3: Create channel dialog and channel page shell</name>
  <files>app/src/components/CreateChannelDialog.tsx, app/src/app/messages/[channelId]/page.tsx</files>
  <action>
**CreateChannelDialog.tsx:**
- Modal/dialog component (can use simple overlay pattern)
- Form fields:
  - Name: required text input
  - Description: optional textarea
  - Type: radio buttons for "Public" (anyone can join) vs "Private" (invite only)
- Submit calls `useMutation(api.channels.createChannel)`
- On success: close dialog, navigate to new channel
- Cancel button to close
- Loading state during creation

**[channelId]/page.tsx:**
- Get channelId from params
- Query channel details with `useQuery(api.channels.getChannel, { channelId })`
- Show channel header: name, description, member count
- Placeholder for message list: "Messages will appear here"
- Placeholder for message input: disabled input
- Handle not-found: "Channel not found" or "You don't have access"

This creates the shell that Plan 03 will populate with actual messaging UI.
  </action>
  <verify>Create channel works, navigates to new channel page</verify>
  <done>Channel creation flow complete, channel page shell working</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] /messages shows two-column layout
- [ ] ChannelList displays user's channels grouped by type
- [ ] Create channel dialog opens from "+" button
- [ ] New channels appear in list immediately (real-time)
- [ ] /messages/[channelId] shows channel header
- [ ] Navigation between channels works
</verification>

<success_criteria>

- Users can browse their channels in sidebar
- Users can create new public/private channels
- Channel pages load with header information
- Real-time updates when channels are created
- Ready for message UI in Plan 03
</success_criteria>

<output>
After completion, create `.planning/phases/10-messaging-channels/10-02-SUMMARY.md`
</output>
