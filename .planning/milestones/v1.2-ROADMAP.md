# Milestone v1.2: Content Architecture

**Status:** ✅ SHIPPED 2026-01-18
**Phases:** 16-23 (7 active, 1 deferred)
**Total Plans:** 23

## Overview

First-principles refactoring of content architecture — how documents are mapped, displayed, and navigated based on intent rather than blind markdown conversion. Transformed the wiki from a simple markdown viewer into a purpose-built content system with semantic rendering, completion tracking, and sharing capabilities.

## Phases

### Phase 16: Code Mapping + Style Audit

**Goal**: Complete codebase mapping (current + desired state visual), style violation inventory
**Depends on**: v1.1 complete
**Plans**: 3/3

Plans:
- [x] 16-01: User flows and navigation mapping (USER-FLOWS.md)
- [x] 16-02: Component-to-data flow mapping and style audit (COMPONENT-MAP.md, STYLE-VIOLATIONS.md)
- [x] 16-03: Target architecture documentation (DESIRED-STATE.md)

**Completed:** 2026-01-17

### Phase 17: Base Component Fixes

**Goal**: Fix components so styling inherits correctly, establish enforcement layer
**Depends on**: Phase 16
**Plans**: 4/4

Plans:
- [x] 17-01: Error color foundation (add tokens, replace hardcoded colors)
- [x] 17-02: Header and DocumentViewer token adoption
- [x] 17-03: FormRenderer and FormBuilder token adoption
- [x] 17-04: CommentSection, MessageList, and UI primitives token adoption

**Completed:** 2026-01-17

### Phase 18: Content Audit + Type Decisions

**Goal**: Full content tracker, apply rules-based type decisions, flag edge cases
**Depends on**: Phase 17
**Plans**: 1/1

Plans:
- [x] 18-FIX: Evidence-based content classification (70 documents, 5 types)

**Completed:** 2026-01-17

### Phase 19: Redundant Content Resolution + IA Redesign

**Goal**: Eliminate duplicates, design new information architecture
**Depends on**: Phase 18
**Plans**: 4/4

Plans:
- [x] 19-01: Schema + Seed Migration (contentType field, mapping, redundant form exclusion)
- [x] 19-02: Navigation Components (QuickActionNav, Header restructure)
- [x] 19-03: Home Page + Verification (listing pages, visual checkpoint)
- [x] 19-FIX: Import index.md files as guide documents

**Completed:** 2026-01-17

### Phase 20: Dynamic Content System

**Goal**: Complete infrastructure for interactive dynamic content — procedures, checklists, and forms that staff can complete, track, and share
**Depends on**: Phase 19
**Plans**: 6/6

Plans:
- [x] 20-01: Schema Foundation (dynamicContentInstances, activityLog, shareLinks tables)
- [x] 20-02: Completion Tracking (dynamicContent.ts mutations/queries, ProcedureSteps, ChecklistView)
- [x] 20-03: Activity System (activity.ts, ActivitySidebar, ActivityDashboard)
- [x] 20-04: Sharing System (sharing.ts, ShareLinkDialog, /share/[token] page)
- [x] 20-05: Integration (ContentTypeRenderer, activity page, wiring)
- [x] 20-FIX: Binary Content Conversion (convert 39 DOCX/XLSX/PDF files to markdown)

**Completed:** 2026-01-17

### Phase 21: Form Builder Visual Rebuild

**Goal**: Section-based builder like Google Forms — visual drag-and-drop interface
**Depends on**: Phase 20
**Plans**: 2/2

Plans:
- [x] 21-01: Foundation + DraggableFieldCard (dnd-kit, inline editing component)
- [x] 21-02: FormBuilder Integration + Visual Verification (refactor, browser testing)

**Completed:** 2026-01-18

### Phase 22: Create Flows + Dashboard (DEFERRED)

**Goal**: Add error handling to folder/document creation flows, simple management dashboard
**Status**: Deferred — flows work when authenticated, error handling is UX polish not blocking

**Findings:**
- Create folder/document mutations work correctly when user is logged in
- Missing: try/catch in UI handlers, error toasts, redirect to signin on auth failure
- Deferred to v1.3 as low priority polish

### Phase 23: UI Refresh

**Goal**: Custom style guide variant optimized for internal wiki+ use case
**Depends on**: Phase 21
**Plans**: 3/3

Plans:
- [x] 23-01: CSS utility classes (infrastructure)
- [x] 23-02: Component CSS refactor (code cleanup)
- [x] 23-03: Full UI Refresh (style guide content, visible CSS, document rendering)

**Completed:** 2026-01-18

---

## Milestone Summary

**Key Decisions:**
- Content types: procedure, reference, form, checklist, guide (Phase 18)
- Purpose-based navigation replaces category-based (Phase 19)
- Form builder is authoritative for data collection — markdown forms excluded (Phase 19)
- Dynamic content uses sessionId for anonymous users + userId for authenticated (Phase 20)
- Border-radius > 0 for UI refresh (overrides v1.1 decision for polish) (Phase 23)

**Issues Resolved:**
- Blind markdown conversion → semantic content type routing
- Misleading navigation → purpose-based QuickActionNav
- Redundant content → form builder authoritative, 13 duplicates excluded
- Modal-heavy form builder → inline drag-and-drop editing

**Issues Deferred to v1.3:**
- Procedures feature broken/never tested — may merge with checklists
- Create flows error handling — works but needs polish
- 12 content type misclassifications identified during execution
- Anonymous dynamic content testing needed

**Technical Debt:**
- Some components still use inline styles (not blocking)
- Phase 22 scope cut — create flows work but lack error handling

---

*For current project status, see .planning/ROADMAP.md*
